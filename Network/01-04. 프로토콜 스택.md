# 01-04. 프로토콜 스택에 메시지 송신을 의뢰한다.

> - `성공과 실패를 결정하는 1%의 네트워크 원리`를 참고하였다.



### 프로토콜 스택

- 프로토콜 스택은 OS에 있는 네트워크 제어용 소프트웨어이다.
- 실제로 서버에 메시지를 송신할 때 프로토콜 스택에 의뢰를 한다.
- 프로토콜 스택에 의뢰를 하면 Socket 라이브러리 프로그램 부품들이 정해진 순서대로 호출되어 실행된다.



### 소켓 생성

- 소켓은 데이터를 보내기위한 통로를 만들기 전에 송신측과 수신측에 개설되는 입구같은 역할을 한다.
- 네트워크 상에서 동작하는 프로그램간의 통신 종착점이라고 할 수 있다.
- 소켓은 인터넷상에서 고유한 주소를 부여하기위해 설계되었다.
  - 만약 크롬 브라우저를 여러 개 실행시키고 하나의 크롬에서 응답을 받아야할 때 소켓을 통해 어떤 크롬에 응답 메시지를 보내야하는지 구분한다.
  - 소켓이 생성되면 **디스크립터**가 생성되고 이를 통해 각각의 어플리케이션을 구분한다.



### 파이프 연결

- 소켓이 생성되었다면 클라이언트는 서버로 파이프 연결을 한다.
- Socket 라이브러리중 하나인 connect를 호출하면 프로토콜 스택이 접속 동작을 실행하고 서버측의 IP주소, 포트 번호 등을 기록하여 통신이 가능한 상태로 만든다.



### 송-수신

- 이제 파이프를 통해 데이터를 보내고 서버측의 소켓에 데이터가 도착하도록 한다.
- Socket 라이브러리에서 write를 통해 데이터를 보내며 read를 통해 메시지를 수신하여 **수신 버퍼**에 저장한다.



